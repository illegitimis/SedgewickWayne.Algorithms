# IKVM vs Porting

Initial approach was to **convert java archives with IKVM**, then **use ILSpy on the generated bytecode** to produce cs files. \
Those files would then have to be stripped off the unnecessary metadata.
Source: `algs4.jar` [algs4 java archive].

**Instead, it seems easier to port java files** from the [Princeton repo] or the duplicated [Brazilian repo].

Files which have been generated by means of `IKVM` and `ILSpy` but not yet included in the project, or _haven't been ported yet_ are listed in the [algorithms to do list](todo.md).

## ikvm

IKVM outputs reside in the [`ante`](./ante) folder and are not included in the project, as compilation targets. \
The approach of refactoring IKVM produced code _was dropped_ because most of the code looked bad, especially inner classes for linked lists, list nodes and enumerators, and even after trimming metadata, severe refactoring was needed.

Replaced tokens: \
`using IKVM.Attributes;`, \
`using java.lang;`, \
`In.__<clinit>();`, \
`[HideFromJava]`, \
`using java.util;`, \
`using ikvm.lang;`,  \
`Throwable.__<suppressFillInStackTrace>();`,  \
`using java.io;`,  \
`using ikvm.@internal;`, \
`: java.lang.Object`, \
`using IKVM.Runtime;`, \
`using System.Runtime.CompilerServices;`, \
`using System;`, \
`[MethodImpl(MethodImplOptions.NoInlining)]`

Replaced regex: \
`\[LineNumberTable\([^\)]+\)\]`, \
 `^.*(\[[^\]\(\)]+\([^\]\(\)]+\)[^\]\(\)]*\])$` with ` \/\/\1`, \
 `(\[Implements\(new string\[\]\r\n[^{]+{[^\]]+\])`,  \
 `\[LineNumberTable\(new byte\[\]\r\n[^{]+{[^}]+\}\)`, \
 `[LineNumberTable(\d\d), Modifiers(Modifiers.Static | Modifiers.Synthetic)]`


[home](../README.md#links)

[course website]: https://algs4.cs.princeton.edu/home/
[Princeton repo]: http://algs4.cs.princeton.edu
[Brazilian repo]: https://www.ime.usp.br/~pf/sedgewick-wayne/algs4/
[algs4 java archive]: https://algs4.cs.princeton.edu/code/algs4.jar